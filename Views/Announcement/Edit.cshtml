@model Topluluk_Yonetim.MVC.Models.ViewModels.AnnouncementEditViewModel
@{
    ViewData["Title"] = "Duyuru Düzenle";
}

<div class="max-w-4xl mx-auto">
    <div class="bg-white rounded-lg shadow-lg p-8">
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-primary mb-2">Duyuru Düzenle</h1>
            <p class="text-gray-600">Mevcut duyuruyu güncelleyebilirsiniz.</p>
        </div>

        @if (TempData["ErrorMessage"] != null)
        {
            <div class="mb-6 bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                @TempData["ErrorMessage"]
            </div>
        }

        <form asp-action="Edit" method="post" class="space-y-6">
            @Html.AntiForgeryToken()
            <input type="hidden" asp-for="Id" />
            <div asp-validation-summary="ModelOnly" class="text-red-600 bg-red-50 border border-red-200 rounded-lg p-4"></div>

            <div>
                <label asp-for="Title" class="block text-sm font-semibold text-primary mb-2">
                    <span class="text-secondary">*</span> @Html.DisplayNameFor(m => m.Title)
                </label>
                <input asp-for="Title" class="w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:border-secondary focus:outline-none transition-colors" />
                <span asp-validation-for="Title" class="text-red-600 text-sm mt-1 block"></span>
            </div>

            <div>
                <label asp-for="Content" class="block text-sm font-semibold text-primary mb-2">
                    <span class="text-secondary">*</span> @Html.DisplayNameFor(m => m.Content)
                </label>
                <textarea asp-for="Content" rows="8" class="w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:border-secondary focus:outline-none transition-colors"></textarea>
                <span asp-validation-for="Content" class="text-red-600 text-sm mt-1 block"></span>
            </div>

            <div>
                <label asp-for="Audience" class="block text-sm font-semibold text-primary mb-2">
                    @Html.DisplayNameFor(m => m.Audience)
                </label>
                @{
                    var allowedAudiences = ViewBag.AllowedAudiences as IEnumerable<Topluluk_Yonetim.MVC.Models.Enums.AnnouncementAudience>
                                           ?? Enum.GetValues(typeof(Topluluk_Yonetim.MVC.Models.Enums.AnnouncementAudience)).Cast<Topluluk_Yonetim.MVC.Models.Enums.AnnouncementAudience>();
                }
                <select asp-for="Audience" class="w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:border-secondary focus:outline-none transition-colors">
                    @foreach (var audience in allowedAudiences)
                    {
                        var text = audience switch
                        {
                            Topluluk_Yonetim.MVC.Models.Enums.AnnouncementAudience.AllStudents => "Tüm Öğrenciler",
                            Topluluk_Yonetim.MVC.Models.Enums.AnnouncementAudience.Presidents => "Başkanlar",
                            Topluluk_Yonetim.MVC.Models.Enums.AnnouncementAudience.ClubMembers => "Kulüp Üyeleri (Seçilen Kulüp)",
                            Topluluk_Yonetim.MVC.Models.Enums.AnnouncementAudience.SpecificClubMembers => "Belirli Kulüp Üyeleri",
                            _ => audience.ToString()
                        };
                        <option value="@((int)audience)" selected="@(Model.Audience == audience)">@text</option>
                    }
                </select>
                <span asp-validation-for="Audience" class="text-red-600 text-sm mt-1 block"></span>
            </div>

            <div>
                <label asp-for="ClubId" class="block text-sm font-semibold text-primary mb-2">
                    @Html.DisplayNameFor(m => m.ClubId)
                </label>
                <select asp-for="ClubId" class="w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:border-secondary focus:outline-none transition-colors">
                    <option value="">Tüm Topluluklar (Genel Duyuru)</option>
                    @if (ViewBag.Clubs != null)
                    {
                        foreach (var club in (List<Topluluk_Yonetim.MVC.Models.Entities.Club>)ViewBag.Clubs)
                        {
                            <option value="@club.Id" selected="@(Model.ClubId == club.Id)">@club.Name</option>
                        }
                    }
                </select>
                <span asp-validation-for="ClubId" class="text-red-600 text-sm mt-1 block"></span>
            </div>

            <div class="flex items-center gap-3">
                <input type="checkbox" asp-for="IsPinned" class="w-5 h-5 text-secondary border-gray-300 rounded focus:ring-secondary" />
                <label asp-for="IsPinned" class="text-sm font-semibold text-primary">
                    @Html.DisplayNameFor(m => m.IsPinned)
                </label>
            </div>

            <div class="flex gap-4 pt-4">
                <button type="submit" class="flex-1 bg-gradient-to-r from-primary to-secondary text-white px-6 py-3 rounded-lg font-semibold hover:shadow-lg transition-all duration-300 hover:-translate-y-0.5">
                    Duyuruyu Güncelle
                </button>
                <a asp-action="Index" class="px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition-colors">
                    İptal
                </a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}


